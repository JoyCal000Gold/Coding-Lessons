# 1. Install Quarto inside your Codespace terminal temporarily (it will disappear when the Codespace stops unless you add it to your devcontainer)
wget https://github.com/quarto-dev/quarto-cli/releases/download/v1.3.313/quarto-1.3.313-linux-amd64.deb
sudo dpkg -i quarto-1.3.313-linux-amd64.deb

# 2. Check installation
quarto --version

# 3. sudo apt update
sudo apt install -y r-base

# 4. Check installation
R --version

# 5. Create directory for user-installed R packages
mkdir -p ~/Rlibs
chmod u+rwx ~/Rlibs

# 6. Set R to use this directory for packages permanently
echo 'R_LIBS_USER="/home/codespace/Rlibs"' >> ~/.Renviron

# 7. In R, reload .Renviron
readRenviron("~/.Renviron")

# 8. Check the variable
Sys.getenv("R_LIBS_USER")
.libPaths()

# . Verify of .Reviron is sourced
Sys.getenv("R_LIBS_USER")
.libPaths()

# Make sure my user library appears first in .libPaths()
mkdir -p ~/Rlibs
chmod u+rwx ~/Rlibs

echo "R_LIBS_USER=\"$HOME/Rlibs\"" >> ~/.Renviron
export R_LIBS_USER="$HOME/Rlibs"

R -e 'install.packages(c("knitr", "rmarkdown", "xfun"), repos="https://cloud.r-project.org", lib=Sys.getenv("R_LIBS_USER"))'

R -e '.libPaths()'

quarto render Lesson-One.qmd

# 3. Export environment variable for current session
export R_LIBS_USER=~/Rlibs

# 4. Install required R packages (knitr, rmarkdown, reticulate) in user directory
R -e 'install.packages(c("knitr", "rmarkdown", "reticulate"), repos="https://cloud.r-project.org", lib="~/Rlibs")'

# 5. Confirm R sees your user library path
R -e '.libPaths()'

# 6. Render your Quarto file
quarto render Lesson-One.qmd

# 7. (Optional) Preview the rendered HTML file in Codespaces
# Right-click Lesson-One.html in Explorer and select "Open with Preview"

